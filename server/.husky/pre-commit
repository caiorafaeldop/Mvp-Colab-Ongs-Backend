#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ• Husky: Validando cÃ³digo antes do commit..."
echo ""

# Navegar para o diretÃ³rio server
cd server

# 1. Lint-staged (Prettier + ESLint nos arquivos staged)
echo "ğŸ“ Rodando formataÃ§Ã£o e lint..."
npx lint-staged

# 2. Verificar uso correto de Singletons
echo ""
echo "ğŸ” Verificando padrÃµes de Singleton..."
npm run verify:singletons

# 3. Rodar testes rÃ¡pidos (apenas Singletons)
echo ""
echo "ğŸ§ª Rodando testes dos Singletons..."
npm run test:singletons -- --bail --maxWorkers=2

echo ""
echo "âœ… Todas as validaÃ§Ãµes passaram! Commit autorizado."
